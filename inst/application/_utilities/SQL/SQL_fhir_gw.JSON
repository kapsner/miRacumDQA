{
  "Person.Demographie.AdministrativesGeschlecht": "SELECT r1.pid AS \"Person.PatientIn.Patienten-Identifikator.Patienten-Identifikator\", r2.jsonbdata2 ->> 'gender' AS \"Person.Demographie.AdministrativesGeschlecht\" FROM ( SELECT * FROM ( SELECT REPLACE(jsonb_path_query(DATA, '$.subject') ->> 'reference', 'Patient/', '') AS pid, to_timestamp(jsonb_path_query(DATA, '$.period') ->> 'start', 'YYYY-MM-DDTHH:MI:SS') AS fhir_start_date FROM resources WHERE TYPE = 'Encounter') AS r_intermediate ) r1, LATERAL ( SELECT DATA AS jsonbdata2 FROM resources WHERE TYPE = 'Patient' AND ( (DATA ->> 'id') = r1.pid) ) r2;",
  "Person.Demographie.Geburtsdatum": "SELECT r1.pid AS \"Person.PatientIn.Patienten-Identifikator.Patienten-Identifikator\", r2.jsonbdata2 ->> 'birthDate' AS \"Person.Demographie.Geburtsdatum\" FROM ( SELECT * FROM ( SELECT REPLACE(jsonb_path_query(DATA, '$.subject') ->> 'reference', 'Patient/', '') AS pid, to_timestamp(jsonb_path_query(DATA, '$.period') ->> 'start', 'YYYY-MM-DDTHH:MI:SS') AS fhir_start_date FROM resources WHERE TYPE = 'Encounter') AS r_intermediate ) r1, LATERAL ( SELECT DATA AS jsonbdata2 FROM resources WHERE TYPE = 'Patient' AND ( (DATA ->> 'id') = r1.pid) ) r2;",
  "Fall.Einrichtungskontakt.Aufnahmenummer": "SELECT r1.pid AS \"Person.PatientIn.Patienten-Identifikator.Patienten-Identifikator\", r1.jsonbdata ->> 'id' AS \"Fall.Einrichtungskontakt.Aufnahmenummer\" FROM ( SELECT * FROM ( SELECT DATA AS jsonbdata, REPLACE(jsonb_path_query(DATA, '$.subject') ->> 'reference', 'Patient/', '') AS pid, to_timestamp(jsonb_path_query(DATA, '$.period') ->> 'start', 'YYYY-MM-DDTHH:MI:SS') AS fhir_start_date FROM resources WHERE TYPE = 'Encounter') AS r_intermediate ) r1;",
  "Person.PatientIn.Patienten-Identifikator.Patienten-Identifikator": "SELECT r1.pid AS \"Person.PatientIn.Patienten-Identifikator.Patienten-Identifikator\", r1.jsonbdata ->> 'id' AS \"Fall.Einrichtungskontakt.Aufnahmenummer\" FROM ( SELECT * FROM ( SELECT DATA AS jsonbdata, REPLACE(jsonb_path_query(DATA, '$.subject') ->> 'reference', 'Patient/', '') AS pid, to_timestamp(jsonb_path_query(DATA, '$.period') ->> 'start', 'YYYY-MM-DDTHH:MI:SS') AS fhir_start_date FROM resources WHERE TYPE = 'Encounter') AS r_intermediate ) r1;",
  "Fall.Einrichtungskontakt.Beginndatum": "SELECT r1.pid AS \"Person.PatientIn.Patienten-Identifikator.Patienten-Identifikator\", to_timestamp(jsonb_path_query(r1.jsonbdata, '$.period') ->> 'start', 'YYYY-MM-DDTHH:MI:SS') AS \"Fall.Einrichtungskontakt.Beginndatum\" FROM ( SELECT * FROM ( SELECT DATA AS jsonbdata, REPLACE(jsonb_path_query(DATA, '$.subject') ->> 'reference', 'Patient/', '') AS pid, to_timestamp(jsonb_path_query(DATA, '$.period') ->> 'start', 'YYYY-MM-DDTHH:MI:SS') AS fhir_start_date FROM resources WHERE TYPE = 'Encounter') AS r_intermediate ) r1;",
  "Fall.Einrichtungskontakt.Enddatum": "SELECT r1.pid AS \"Person.PatientIn.Patienten-Identifikator.Patienten-Identifikator\", to_timestamp(jsonb_path_query(r1.jsonbdata, '$.period') ->> 'end', 'YYYY-MM-DDTHH:MI:SS') AS \"Fall.Einrichtungskontakt.Enddatum\" FROM ( SELECT * FROM ( SELECT DATA AS jsonbdata, REPLACE(jsonb_path_query(DATA, '$.subject') ->> 'reference', 'Patient/', '') AS pid, to_timestamp(jsonb_path_query(DATA, '$.period') ->> 'start', 'YYYY-MM-DDTHH:MI:SS') AS fhir_start_date FROM resources WHERE TYPE = 'Encounter') AS r_intermediate ) r1;",
  "Person.Demographie.Adresse.Strassenanschrift.PLZ": "SELECT r1.pid AS \"Person.PatientIn.Patienten-Identifikator.Patienten-Identifikator\", jsonb_array_elements(jsonb_path_query(r2.jsonbdata2, '$.address')) ->> 'postalCode' AS \"Person.Demographie.Adresse.Strassenanschrift.PLZ\" FROM ( SELECT * FROM ( SELECT REPLACE(jsonb_path_query(DATA, '$.subject') ->> 'reference', 'Patient/', '') AS pid, to_timestamp(jsonb_path_query(DATA, '$.period') ->> 'start', 'YYYY-MM-DDTHH:MI:SS') AS fhir_start_date FROM resources WHERE TYPE = 'Encounter') AS r_intermediate ) r1, LATERAL ( SELECT DATA AS jsonbdata2 FROM resources WHERE TYPE = 'Patient' AND ( (DATA ->> 'id') = r1.pid) ) r2;",
  "Diagnose.ICD10GMDiagnoseKodiert.VollstaendigerDiagnosekode": "SELECT r1.jsonbdata ->> 'id' AS \"Fall.Einrichtungskontakt.Aufnahmenummer\", jsonb_array_elements(jsonb_path_query(r2.jsonbdata2, '$.code.coding')) ->> 'code' AS \"Diagnose.ICD10GMDiagnoseKodiert.VollstaendigerDiagnosekode \" FROM ( SELECT * FROM ( SELECT DATA AS jsonbdata, to_timestamp(jsonb_path_query(DATA, '$.period') ->> 'start', 'YYYY-MM-DDTHH:MI:SS') AS fhir_start_date FROM resources WHERE TYPE = 'Encounter') AS r_intermediate ) r1, LATERAL ( SELECT DATA AS jsonbdata2 FROM resources WHERE TYPE = 'Condition' AND ( REPLACE(DATA -> 'encounter' ->> 'reference', 'Encounter/', '') = (r1.jsonbdata ->> 'id') )) r2;",
  "Prozedur.OPSProzedurKodiert.VollstaendigerProzedurenkode": "SELECT r1.jsonbdata ->> 'id' AS \"Fall.Einrichtungskontakt.Aufnahmenummer\", jsonb_array_elements(jsonb_path_query(r2.jsonbdata2, '$.code.coding')) ->> 'code' AS \"Prozedur.OPSProzedurKodiert.VollstaendigerProzedurenkode\" FROM ( SELECT * FROM ( SELECT DATA AS jsonbdata, to_timestamp(jsonb_path_query(DATA, '$.period') ->> 'start', 'YYYY-MM-DDTHH:MI:SS') AS fhir_start_date FROM resources WHERE TYPE = 'Encounter') AS r_intermediate ) r1, LATERAL ( SELECT DATA AS jsonbdata2 FROM resources WHERE TYPE = 'Procedure' AND ( REPLACE(DATA -> 'encounter' ->> 'reference', 'Encounter/', '') = (r1.jsonbdata ->> 'id') )) r2;",
  "Fall.Abteilungskontakt.Fachabteilungsschluessel": "r1.jsonbdata ->> 'id' AS \"Fall.Einrichtungskontakt.Aufnahmenummer\", r1.code AS \"Fall.Abteilungskontakt.Fachabteilungsschluessel\" FROM ( SELECT jsonbdata, service_type ->> 'code' AS code, service_type ->> 'system' AS cd_system FROM ( SELECT DATA AS jsonbdata, jsonb_array_elements(jsonb_path_query(DATA, '$.serviceType.coding')) AS service_type, to_timestamp(jsonb_path_query(DATA, '$.period') ->> 'start', 'YYYY-MM-DDTHH:MI:SS') AS fhir_start_date FROM resources WHERE TYPE = 'Encounter') AS r_intermediate ) r1 WHERE r1.cd_system = 'https://www.medizininformatik-initiative.de/fhir/core/modul-fall/CodeSystem/Fachabteilungsschluessel';",
  "Fall.Einrichtungskontakt.Entlassungsgrund": "SELECT r1.jsonbdata ->> 'id' AS \"Fall.Einrichtungskontakt.Aufnahmenummer\",  jsonb_array_elements(jsonb_path_query(r1.jsonbdata, '$.hospitalization')) ->> 'dischargeDisposition' AS \"Fall.Einrichtungskontakt.Entlassungsgrund\" FROM ( SELECT * FROM ( SELECT DATA AS jsonbdata, to_timestamp(jsonb_path_query(DATA, '$.period') ->> 'start', 'YYYY-MM-DDTHH:MI:SS') AS fhir_start_date FROM resources WHERE TYPE = 'Encounter') AS r_intermediate ) r1;",
  "Fall.Einrichtungskontakt.Aufnahmeanlass": "SELECT r1.jsonbdata ->> 'id' AS \"Fall.Einrichtungskontakt.Aufnahmenummer\",  jsonb_array_elements(jsonb_path_query(r1.jsonbdata, '$.hospitalization')) ->> 'admitSource' AS \"Fall.Einrichtungskontakt.Aufnahmeanlass\" FROM ( SELECT * FROM ( SELECT DATA AS jsonbdata, to_timestamp(jsonb_path_query(DATA, '$.period') ->> 'start', 'YYYY-MM-DDTHH:MI:SS') AS fhir_start_date FROM resources WHERE TYPE = 'Encounter') AS r_intermediate ) r1;",
  "Fall.Einrichtungskontakt.Aufnahmegrund": "SELECT r1.jsonbdata ->> 'id' AS \"Fall.Einrichtungskontakt.Aufnahmenummer\",  r1.jsonbdata ->> 'reasonCode' AS \"Fall.Einrichtungskontakt.Aufnahmegrund\" FROM ( SELECT * FROM ( SELECT DATA AS jsonbdata, to_timestamp(jsonb_path_query(DATA, '$.period') ->> 'start', 'YYYY-MM-DDTHH:MI:SS') AS fhir_start_date FROM resources WHERE TYPE = 'Encounter') AS r_intermediate ) r1;",
  "Laborbefund.Laboruntersuchung.Code": "SELECT r1.jsonbdata ->> 'id' AS \"Fall.Einrichtungskontakt.Aufnahmenummer\", r2.code AS \"Laborbefund.Laboruntersuchung.Code\" FROM ( SELECT * FROM ( SELECT DATA AS jsonbdata, to_timestamp(jsonb_path_query(DATA, '$.period') ->> 'start', 'YYYY-MM-DDTHH:MI:SS') AS fhir_start_date FROM resources WHERE TYPE = 'Encounter') AS r_intermediate) r1, LATERAL ( SELECT cd_system ->> 'code' AS code, cd_system ->> 'system' AS cd_system FROM ( SELECT DATA AS jsonbdata2, jsonb_array_elements(jsonb_path_query(DATA, '$.code.coding')) AS cd_system, jsonb_array_elements(jsonb_path_query(DATA, '$.category.coding')) AS cd_category FROM resources WHERE TYPE = 'Observation' AND ( REPLACE(DATA -> 'encounter' ->> 'reference', 'Encounter/', '') = (r1.jsonbdata ->> 'id') )) AS r3 WHERE r3.cd_system ->> 'system' = 'http://loinc.org' AND r3.cd_category ->> 'code' = '26436-6' ) r2;"
}