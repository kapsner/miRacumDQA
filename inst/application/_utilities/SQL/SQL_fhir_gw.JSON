{
  "Person.Demographie.AdministrativesGeschlecht": "SELECT r1.pid AS \"Person.PatientIn.Patienten-Identifikator.Patienten-Identifikator\", r2.jsonbdata2 ->> 'gender' AS \"Person.Demographie.AdministrativesGeschlecht\" FROM ( SELECT * FROM ( SELECT REPLACE(jsonb_path_query(DATA, '$.subject') ->> 'reference', 'Patient/', '') AS pid, to_timestamp(jsonb_path_query(DATA, '$.period') ->> 'start', 'YYYY-MM-DDTHH:MI:SS') AS fhir_start_date FROM resources WHERE TYPE = 'Encounter') AS r_intermediate ) r1, LATERAL ( SELECT DATA AS jsonbdata2 FROM resources WHERE TYPE = 'Patient' AND ( (DATA ->> 'id') = r1.pid) ) r2;",
  "Person.Demographie.Geburtsdatum": "SELECT r1.pid AS \"Person.PatientIn.Patienten-Identifikator.Patienten-Identifikator\", r2.jsonbdata2 ->> 'birthDate' AS \"Person.Demographie.Geburtsdatum\" FROM ( SELECT * FROM ( SELECT REPLACE(jsonb_path_query(DATA, '$.subject') ->> 'reference', 'Patient/', '') AS pid, to_timestamp(jsonb_path_query(DATA, '$.period') ->> 'start', 'YYYY-MM-DDTHH:MI:SS') AS fhir_start_date FROM resources WHERE TYPE = 'Encounter') AS r_intermediate ) r1, LATERAL ( SELECT DATA AS jsonbdata2 FROM resources WHERE TYPE = 'Patient' AND ( (DATA ->> 'id') = r1.pid) ) r2;",
  "Fall.Einrichtungskontakt.Aufnahmenummer": "SELECT r1.pid AS \"Person.PatientIn.Patienten-Identifikator.Patienten-Identifikator\", r1.jsonbdata ->> 'id' AS \"Fall.Einrichtungskontakt.Aufnahmenummer\" FROM ( SELECT * FROM ( SELECT DATA AS jsonbdata, REPLACE(jsonb_path_query(DATA, '$.subject') ->> 'reference', 'Patient/', '') AS pid, to_timestamp(jsonb_path_query(DATA, '$.period') ->> 'start', 'YYYY-MM-DDTHH:MI:SS') AS fhir_start_date FROM resources WHERE TYPE = 'Encounter') AS r_intermediate ) r1;",
  "Person.PatientIn.Patienten-Identifikator.Patienten-Identifikator": "SELECT r1.pid AS \"Person.PatientIn.Patienten-Identifikator.Patienten-Identifikator\", r1.jsonbdata ->> 'id' AS \"Fall.Einrichtungskontakt.Aufnahmenummer\" FROM ( SELECT * FROM ( SELECT DATA AS jsonbdata, REPLACE(jsonb_path_query(DATA, '$.subject') ->> 'reference', 'Patient/', '') AS pid, to_timestamp(jsonb_path_query(DATA, '$.period') ->> 'start', 'YYYY-MM-DDTHH:MI:SS') AS fhir_start_date FROM resources WHERE TYPE = 'Encounter') AS r_intermediate ) r1;",
  "Fall.Einrichtungskontakt.Beginndatum": "SELECT r1.pid AS \"Person.PatientIn.Patienten-Identifikator.Patienten-Identifikator\", to_timestamp(jsonb_path_query(r1.jsonbdata, '$.period') ->> 'start', 'YYYY-MM-DDTHH:MI:SS') AS \"Fall.Einrichtungskontakt.Beginndatum\" FROM ( SELECT * FROM ( SELECT DATA AS jsonbdata, REPLACE(jsonb_path_query(DATA, '$.subject') ->> 'reference', 'Patient/', '') AS pid, to_timestamp(jsonb_path_query(DATA, '$.period') ->> 'start', 'YYYY-MM-DDTHH:MI:SS') AS fhir_start_date FROM resources WHERE TYPE = 'Encounter') AS r_intermediate ) r1;",
  "Fall.Einrichtungskontakt.Enddatum": "SELECT r1.pid AS \"Person.PatientIn.Patienten-Identifikator.Patienten-Identifikator\", to_timestamp(jsonb_path_query(r1.jsonbdata, '$.period') ->> 'end', 'YYYY-MM-DDTHH:MI:SS') AS \"Fall.Einrichtungskontakt.Enddatum\" FROM ( SELECT * FROM ( SELECT DATA AS jsonbdata, REPLACE(jsonb_path_query(DATA, '$.subject') ->> 'reference', 'Patient/', '') AS pid, to_timestamp(jsonb_path_query(DATA, '$.period') ->> 'start', 'YYYY-MM-DDTHH:MI:SS') AS fhir_start_date FROM resources WHERE TYPE = 'Encounter') AS r_intermediate ) r1;",
  "Person.Demographie.Adresse.Strassenanschrift.PLZ": "SELECT r1.pid AS \"Person.PatientIn.Patienten-Identifikator.Patienten-Identifikator\", jsonb_array_elements(jsonb_path_query(r2.jsonbdata2, '$.address')) ->> 'postalCode' AS \"Person.Demographie.Adresse.Strassenanschrift.PLZ\" FROM ( SELECT * FROM ( SELECT REPLACE(jsonb_path_query(DATA, '$.subject') ->> 'reference', 'Patient/', '') AS pid, to_timestamp(jsonb_path_query(DATA, '$.period') ->> 'start', 'YYYY-MM-DDTHH:MI:SS') AS fhir_start_date FROM resources WHERE TYPE = 'Encounter') AS r_intermediate ) r1, LATERAL ( SELECT DATA AS jsonbdata2 FROM resources WHERE TYPE = 'Patient' AND ( (DATA ->> 'id') = r1.pid) ) r2;",
  "Diagnose.ICD10GMDiagnoseKodiert.VollstaendigerDiagnosekode": "SELECT r1.jsonbdata ->> 'id' AS \"Fall.Einrichtungskontakt.Aufnahmenummer\", jsonb_array_elements(jsonb_path_query(r2.jsonbdata2, '$.code.coding')) ->> 'code' AS \"Diagnose.ICD10GMDiagnoseKodiert.Vollstu00e4ndigerDiagnosecode\" FROM ( SELECT * FROM ( SELECT DATA AS jsonbdata, to_timestamp(jsonb_path_query(DATA, '$.period') ->> 'start', 'YYYY-MM-DDTHH:MI:SS') AS fhir_start_date FROM resources WHERE TYPE = 'Encounter') AS r_intermediate ) r1, LATERAL ( SELECT DATA AS jsonbdata2 FROM resources WHERE TYPE = 'Condition' AND ( REPLACE(DATA -> 'encounter' ->> 'reference', 'Encounter/', '') = (r1.jsonbdata ->> 'id') )) r2;",
  "Prozedur.OPSProzedurKodiert.VollstaendigerProzedurenkode": "SELECT r1.jsonbdata ->> 'id' AS \"Fall.Einrichtungskontakt.Aufnahmenummer\", jsonb_array_elements(jsonb_path_query(r2.jsonbdata2, '$.code.coding')) ->> 'code' AS \"Prozedur.OPSProzedurKodiert.VollstaendigerProzedurenkode\" FROM ( SELECT * FROM ( SELECT DATA AS jsonbdata, to_timestamp(jsonb_path_query(DATA, '$.period') ->> 'start', 'YYYY-MM-DDTHH:MI:SS') AS fhir_start_date FROM resources WHERE TYPE = 'Encounter') AS r_intermediate ) r1, LATERAL ( SELECT DATA AS jsonbdata2 FROM resources WHERE TYPE = 'Procedure' AND ( REPLACE(DATA -> 'encounter' ->> 'reference', 'Encounter/', '') = (r1.jsonbdata ->> 'id') )) r2;",
  "Fall.Abteilungskontakt.Fachabteilungsschluessel": "SELECT r1.jsonbdata ->> 'id' AS \"Fall.Einrichtungskontakt.Aufnahmenummer\",  jsonb_array_elements(jsonb_path_query(r1.jsonbdata, '$.serviceType.coding')) ->> 'code' AS \"Fall.Abteilungskontakt.Fachabteilungsschluessel\" FROM ( SELECT * FROM ( SELECT DATA AS jsonbdata, to_timestamp(jsonb_path_query(DATA, '$.period') ->> 'start', 'YYYY-MM-DDTHH:MI:SS') AS fhir_start_date, jsonb_array_elements(jsonb_path_query(DATA, '$.serviceType.coding')) ->> 'system' AS code_system FROM resources WHERE TYPE = 'Encounter') AS r_intermediate ) r1;"
}