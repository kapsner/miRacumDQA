{
  "Person.Demographie.AdministrativesGeschlecht": "SELECT r1.pid AS \"Person.PatientIn.Patienten-Identifikator.Patienten-Identifikator\", r2.jsonbdata2 ->> 'gender' AS \"Person.Demographie.AdministrativesGeschlecht\" FROM ( SELECT * FROM ( SELECT REPLACE(jsonb_path_query(DATA, '$.subject') ->> 'reference', 'Patient/', '') AS pid, to_timestamp(jsonb_path_query(DATA, '$.period') ->> 'start', 'YYYY-MM-DDTHH:MI:SS') AS fhir_start_date FROM resources WHERE TYPE = 'Encounter') AS r_intermediate ) r1 LEFT JOIN ( SELECT fhir_id, DATA AS jsonbdata2 FROM resources WHERE TYPE = 'Patient') r2 ON r2.fhir_id = r1.pid;",
  "Person.Demographie.Geburtsdatum": "SELECT r1.pid AS \"Person.PatientIn.Patienten-Identifikator.Patienten-Identifikator\", r2.jsonbdata2 ->> 'birthDate' AS \"Person.Demographie.Geburtsdatum\" FROM ( SELECT * FROM ( SELECT REPLACE(jsonb_path_query(DATA, '$.subject') ->> 'reference', 'Patient/', '') AS pid, to_timestamp(jsonb_path_query(DATA, '$.period') ->> 'start', 'YYYY-MM-DDTHH:MI:SS') AS fhir_start_date FROM resources WHERE TYPE = 'Encounter') AS r_intermediate ) r1 LEFT JOIN ( SELECT fhir_id, DATA AS jsonbdata2 FROM resources WHERE TYPE = 'Patient') r2 ON r2.fhir_id = r1.pid;",
  "Fall.Einrichtungskontakt.Aufnahmenummer": "SELECT r1.pid AS \"Person.PatientIn.Patienten-Identifikator.Patienten-Identifikator\", r1.fhir_id AS \"Fall.Einrichtungskontakt.Aufnahmenummer\" FROM ( SELECT * FROM ( SELECT fhir_id, REPLACE(jsonb_path_query(DATA, '$.subject') ->> 'reference', 'Patient/', '') AS pid, to_timestamp(jsonb_path_query(DATA, '$.period') ->> 'start', 'YYYY-MM-DDTHH:MI:SS') AS fhir_start_date FROM resources WHERE TYPE = 'Encounter') AS r_intermediate ) r1;",
  "Person.PatientIn.Patienten-Identifikator.Patienten-Identifikator": "SELECT r1.pid AS \"Person.PatientIn.Patienten-Identifikator.Patienten-Identifikator\", r1.fhir_id AS \"Fall.Einrichtungskontakt.Aufnahmenummer\" FROM ( SELECT * FROM ( SELECT fhir_id, REPLACE(jsonb_path_query(DATA, '$.subject') ->> 'reference', 'Patient/', '') AS pid, to_timestamp(jsonb_path_query(DATA, '$.period') ->> 'start', 'YYYY-MM-DDTHH:MI:SS') AS fhir_start_date FROM resources WHERE TYPE = 'Encounter') AS r_intermediate ) r1;",
  "Fall.Einrichtungskontakt.Beginndatum": "SELECT fhir_id AS \"Fall.Einrichtungskontakt.Aufnahmenummer\", fhir_start_date AS \"Fall.Einrichtungskontakt.Beginndatum\" FROM ( SELECT * FROM ( SELECT fhir_id, to_timestamp(jsonb_path_query(DATA, '$.period') ->> 'start', 'YYYY-MM-DDTHH:MI:SS') AS fhir_start_date FROM resources WHERE TYPE = 'Encounter') AS r_intermediate ) r1;",
  "Fall.Einrichtungskontakt.Enddatum": "SELECT fhir_id AS \"Fall.Einrichtungskontakt.Aufnahmenummer\", to_timestamp(jsonb_path_query(r1.jsonbdata, '$.period') ->> 'end', 'YYYY-MM-DDTHH:MI:SS') AS \"Fall.Einrichtungskontakt.Enddatum\" FROM ( SELECT * FROM ( SELECT fhir_id, DATA AS jsonbdata, to_timestamp(jsonb_path_query(DATA, '$.period') ->> 'start', 'YYYY-MM-DDTHH:MI:SS') AS fhir_start_date FROM resources WHERE TYPE = 'Encounter') AS r_intermediate ) r1;",
  "Person.Demographie.Adresse.Strassenanschrift.PLZ": "SELECT r1.pid AS \"Person.PatientIn.Patienten-Identifikator.Patienten-Identifikator\", jsonb_array_elements(jsonb_path_query(r2.jsonbdata2, '$.address')) ->> 'postalCode' AS \"Person.Demographie.Adresse.Strassenanschrift.PLZ\" FROM ( SELECT * FROM ( SELECT REPLACE(jsonb_path_query(DATA, '$.subject') ->> 'reference', 'Patient/', '') AS pid, to_timestamp(jsonb_path_query(DATA, '$.period') ->> 'start', 'YYYY-MM-DDTHH:MI:SS') AS fhir_start_date FROM resources WHERE TYPE = 'Encounter') AS r_intermediate ) r1 LEFT JOIN ( SELECT fhir_id, DATA AS jsonbdata2 FROM resources WHERE TYPE = 'Patient') r2 ON r2.fhir_id = r1.pid;",
  "Diagnose.ICD10GMDiagnoseKodiert.VollstaendigerDiagnosekode": "SELECT r1.fhir_id AS \"Fall.Einrichtungskontakt.Aufnahmenummer\", jsonb_array_elements(jsonb_path_query(r2.jsonbdata2, '$.code.coding')) ->> 'code' AS \"Diagnose.ICD10GMDiagnoseKodiert.VollstaendigerDiagnosekode\" FROM ( SELECT * FROM ( SELECT fhir_id, to_timestamp(jsonb_path_query(DATA, '$.period') ->> 'start', 'YYYY-MM-DDTHH:MI:SS') AS fhir_start_date FROM resources WHERE TYPE = 'Encounter') AS r_intermediate ) r1 LEFT JOIN ( SELECT REPLACE(DATA -> 'encounter' ->> 'reference', 'Encounter/', '') AS eid, DATA AS jsonbdata2 FROM resources WHERE TYPE = 'Condition') r2 ON r2.eid = r1.fhir_id;",
  "Prozedur.OPSProzedurKodiert.VollstaendigerProzedurenkode": "SELECT r1.fhir_id AS \"Fall.Einrichtungskontakt.Aufnahmenummer\", jsonb_array_elements(jsonb_path_query(r2.jsonbdata2, '$.code.coding')) ->> 'code' AS \"Prozedur.OPSProzedurKodiert.VollstaendigerProzedurenkode\" FROM ( SELECT * FROM ( SELECT fhir_id, to_timestamp(jsonb_path_query(DATA, '$.period') ->> 'start', 'YYYY-MM-DDTHH:MI:SS') AS fhir_start_date FROM resources WHERE TYPE = 'Encounter') AS r_intermediate ) r1 LEFT JOIN ( SELECT REPLACE(DATA -> 'encounter' ->> 'reference', 'Encounter/', '') AS eid, DATA AS jsonbdata2 FROM resources WHERE TYPE = 'Procedure') r2 ON r2.eid = r1.fhir_id;",
  "Fall.Abteilungskontakt.Fachabteilungsschluessel": "SELECT r1.fhir_id AS \"Fall.Einrichtungskontakt.Aufnahmenummer\", r1.code AS \"Fall.Abteilungskontakt.Fachabteilungsschluessel\" FROM ( SELECT fhir_id, code, cd_system FROM ( SELECT fhir_id, jsonb_array_elements(jsonb_path_query(DATA, '$.serviceType.coding')) ->> 'code' AS code, jsonb_array_elements(jsonb_path_query(DATA, '$.serviceType.coding')) ->> 'system' AS cd_system, to_timestamp(jsonb_path_query(DATA, '$.period') ->> 'start', 'YYYY-MM-DDTHH:MI:SS') AS fhir_start_date FROM resources WHERE TYPE = 'Encounter') AS r_intermediate ) r1 WHERE r1.cd_system = 'https://www.medizininformatik-initiative.de/fhir/core/modul-fall/CodeSystem/Fachabteilungsschluessel';",
  "Fall.Einrichtungskontakt.Entlassungsgrund": "SELECT r1.fhir_id AS \"Fall.Einrichtungskontakt.Aufnahmenummer\", jsonb_array_elements(jsonb_path_query(r1.jsonbdata, '$.hospitalization')) ->> 'dischargeDisposition' AS \"Fall.Einrichtungskontakt.Entlassungsgrund\" FROM ( SELECT * FROM ( SELECT fhir_id, DATA AS jsonbdata, to_timestamp(jsonb_path_query(DATA, '$.period') ->> 'start', 'YYYY-MM-DDTHH:MI:SS') AS fhir_start_date FROM resources WHERE TYPE = 'Encounter') AS r_intermediate ) r1;",
  "Fall.Einrichtungskontakt.Aufnahmeanlass": "SELECT r1.fhir_id AS \"Fall.Einrichtungskontakt.Aufnahmenummer\", jsonb_array_elements(jsonb_path_query(r1.jsonbdata, '$.hospitalization')) ->> 'admitSource' AS \"Fall.Einrichtungskontakt.Aufnahmeanlass\" FROM ( SELECT * FROM ( SELECT fhir_id, DATA AS jsonbdata, to_timestamp(jsonb_path_query(DATA, '$.period') ->> 'start', 'YYYY-MM-DDTHH:MI:SS') AS fhir_start_date FROM resources WHERE TYPE = 'Encounter') AS r_intermediate ) r1;",
  "Fall.Einrichtungskontakt.Aufnahmegrund": "SELECT r1.fhir_id AS \"Fall.Einrichtungskontakt.Aufnahmenummer\", r1.jsonbdata ->> 'reasonCode' AS \"Fall.Einrichtungskontakt.Aufnahmegrund\" FROM ( SELECT * FROM ( SELECT fhir_id, DATA AS jsonbdata, to_timestamp(jsonb_path_query(DATA, '$.period') ->> 'start', 'YYYY-MM-DDTHH:MI:SS') AS fhir_start_date FROM resources WHERE TYPE = 'Encounter') AS r_intermediate ) r1;",
  "Laborbefund.Laboruntersuchung.Code": "SELECT r1.fhir_id AS \"Fall.Einrichtungskontakt.Aufnahmenummer\", r2.cd_system ->> 'code' AS \"Laborbefund.Laboruntersuchung.Code\" FROM ( SELECT * FROM ( SELECT fhir_id, to_timestamp(jsonb_path_query(DATA, '$.period') ->> 'start', 'YYYY-MM-DDTHH:MI:SS') AS fhir_start_date FROM resources WHERE TYPE = 'Encounter') AS r_intermediate) r1 LEFT JOIN ( SELECT REPLACE(jsonbdata2 -> 'encounter' ->> 'reference', 'Encounter/', '') AS eid, cd_system FROM ( SELECT DATA AS jsonbdata2, jsonb_array_elements(jsonb_path_query(DATA, '$.code.coding')) AS cd_system, jsonb_array_elements(jsonb_path_query(DATA, '$.category.coding')) AS cd_category FROM resources WHERE TYPE = 'Observation') r3 WHERE r3.cd_system ->> 'system' = 'http://loinc.org' AND r3.cd_category ->> 'code' = '26436-6' ) r2 ON r2.eid = r1.fhir_id;"
}